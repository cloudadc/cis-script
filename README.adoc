= F5 CIS 101
:toc: manual

== LoadBalancer Type Service

[source, bash]
.*1. Install both CIS and IPAM Controller*
----
kubectl apply -f loadbalancer/install/ns.yaml 

kubectl apply -f loadbalancer/install/ipam/rbac.yaml
kubectl apply -f loadbalancer/install/ipam/localstorage-pv-pvc.yaml
kubectl apply -f loadbalancer/install/ipam/ipam_schema.yaml
kubectl apply -f loadbalancer/install/ipam/fic.yaml 

kubectl create secret generic bigip-login --from-literal=username=admin --from-literal=password=admin -n bigip-ctlr
kubectl apply -f loadbalancer/install/rbac.yaml 
kubectl apply -f loadbalancer/install/customresourcedefinitions.yaml 
kubectl apply -f loadbalancer/install/cis.yaml
----

Execute `kubectl get pods -n bigip-ctlr` to verify the installation.

[source, bash]
.*2. Deploy App*
----
kubectl apply -f loadbalancer/ttcp.yaml
kubectl apply -f loadbalancer/cafe.yaml 
----

== CRD

[source, bash]
.*1. Install CIS Controller*
----
kubectl apply -f crd/install/ns.yaml
kubectl create secret generic bigip-login --from-literal=username=admin --from-literal=password=admin -n bigip-ctlr
kubectl apply -f crd/install/rbac.yaml
kubectl apply -f crd/install/customresourcedefinitions.yaml
kubectl apply -f crd/install/cis.yaml
----

[source, bash]
.*2. Deploy app*
----
kubectl apply -f crd/cafe.yaml 
kubectl apply -f crd/ttcp.yaml
----

[source, bash]
.*3. App delivery*
----
kubectl apply -f crd/vs.yaml 
kubectl apply -f crd/transport.yaml 
----

== CRD Arcadia Demo

[source, bash]
.*1. Deploy*
----
kubectl apply -f arcadia/arcadia.yaml 
----

[source, bash]
.*2. App delivery*
----
kubectl apply -f arcadia/vs.yaml 
----

== AS3 Hub Mode

[source, bash]
.*1. Install CIS Controller*
----
kubectl apply -f as3-hub/install/ns.yaml
kubectl create secret generic bigip-login --from-literal=username=admin --from-literal=password=admin -n bigip-ctlr
kubectl apply -f as3-hub/install/rbac.yaml
kubectl apply -f as3-hub/install/cis.yaml 
----

[source, bash]
.*2. Deploy App*
----
kubectl apply -f as3-hub/apps.yaml
----

[source, bash]
.*3. Deploy Configmap*
----
kubectl apply -f as3-hub/cm-hub-1.yaml
kubectl apply -f as3-hub/cm-hub-2.yaml 
----

[source, bash]
.*4. Verify deployment via tmsh*
----
~ # tmsh list auth partition | grep cistest | awk '{print $3}'
cistest1
cistest2
cistest3
cistest4
cistest5

~ # tmsh list ltm virtual /cistest3/app-1/app_svc_vs | grep reset 
    service-down-immediate-action reset
----

[source, bash]
.**
----

----

[source, bash]
.**
----

----

[source, bash]
.**
----

----

